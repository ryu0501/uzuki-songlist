<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>兎月詩 歌える曲一覧 ver.1.9</title>
<style>
  body {
    text-align: center;
    background-color: #ffffff;
    margin: 0;
    padding: 0;
  }
  table {
    width: 99%;
    border-collapse: collapse;
    margin: 20px auto;
    font-size: 20px;
  }
  th, td {
    border: 1px solid black;
    padding: 8px;
    text-align: left;
  }
  th {
    cursor: pointer;
  }
  .artist-name { width: 200px; }
  .song-name { width: 300px; }
  .song-id { width: 25px; }
  .hidden {
    display: none;
  }
  .highlight {
    background-color: yellow;
    border: 1px solid black;
  }
  #searchInput {
    margin: 20px 0;
    padding: 7px;
    width: 50%;
    font-size: 40px;
    box-sizing: border-box;
  }
  tbody tr:nth-child(odd) {
    background-color: #d2d2d2;
  }
  tbody tr:nth-child(even) {
    background-color: #ffffff;
  }

  /* レスポンシブ対応 */
  @media (min-width: 1024px) {
    .artist-name { width: 200px; }
    .song-name { width: 300px; }
  }
  @media (min-width: 768px) and (max-width: 1023px) {
    .artist-name { width: 150px; }
    .song-name { width: 250px; }
    table { width: 100%; }
  }
  @media (max-width: 767px) {
    .artist-name { width: 100px; }
    .song-name { width: 200px; }
    table { width: 100%; }
    #searchInput { width: 80%; }
  }
</style>
</head>
<body>

<h2>兎月詩 歌える曲一覧 ver.1.9</h2>
<input type="text" id="searchInput" placeholder="検索...">

<table id="songsTable">
  <thead>
    <tr>
      <th class="artist-name" onclick="sortTable(0)">アーティスト名</th>
      <th class="hidden">アーティスト名読み仮名</th>
      <th class="song-name" onclick="sortTable(2)">曲名</th>
      <th class="hidden">曲名読み仮名</th>
      <th class="song-id" onclick="sortTable(4)">管理番号</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="artist-name">※アーティスト情報なし</td>
      <td class="hidden">なしナシ</td>
      <td class="song-name">いかないで</td>
      <td class="hidden">いかないでイカナイデ</td>
      <td class="song-id">001</td>
    </tr>
    <tr>
      <td class="artist-name">※アーティスト情報なし</td>
      <td class="hidden">なしナシ</td>
      <td class="song-name">カーロ・ミオ・ベン</td>
      <td class="hidden">かーろ・みお・べんカーロ・ミオ・ベン</td>
      <td class="song-id">189</td>
    </tr>
  </tbody>
</table>

<script>
  function normalizeString(str) {
    return str.replace(/[Ａ-Ｚａ-ｚ０-９]/g, function (s) {
      return String.fromCharCode(s.charCodeAt(0) - 0xFEE0);
    }).toUpperCase();
  }

  document.getElementById('searchInput').addEventListener('keyup', function () {
    const filter = normalizeString(this.value);
    const rows = document.getElementById("songsTable").getElementsByTagName("tr");

    for (let i = 1; i < rows.length; i++) {
      const artistTd = rows[i].getElementsByTagName("td")[0];
      const artistPhoneticTd = rows[i].getElementsByTagName("td")[1];
      const songTd = rows[i].getElementsByTagName("td")[2];
      const songPhoneticTd = rows[i].getElementsByTagName("td")[3];
      const songIdTd = rows[i].getElementsByTagName("td")[4];

      const artist = normalizeString(artistTd.textContent);
      const artistPhonetic = normalizeString(artistPhoneticTd.textContent);
      const song = normalizeString(songTd.textContent);
      const songPhonetic = normalizeString(songPhoneticTd.textContent);
      const songId = normalizeString(songIdTd.textContent);

      // ハイライトリセット
      artistTd.classList.remove('highlight');
      songTd.classList.remove('highlight');
      songIdTd.classList.remove('highlight');

      if (filter === "") {
        rows[i].style.display = "";
      } else {
        if (artist.includes(filter) || artistPhonetic.includes(filter)) {
          artistTd.classList.add('highlight');
        }
        if (song.includes(filter) || songPhonetic.includes(filter)) {
          songTd.classList.add('highlight');
        }

        const match = (
          artist.includes(filter) ||
          artistPhonetic.includes(filter) ||
          song.includes(filter) ||
          songPhonetic.includes(filter) ||
          songId.includes(filter)
        );
        rows[i].style.display = match ? "" : "none";
      }
    }
  });

  let sortDirections = {};

  function sortTable(displayColIndex) {
    const table = document.getElementById("songsTable");
    const tbody = table.tBodies[0];
    const rows = Array.from(tbody.rows);
    const hiddenColIndex = displayColIndex + 1;

    sortDirections[displayColIndex] = !sortDirections[displayColIndex];
    const ascending = sortDirections[displayColIndex];

    rows.sort((a, b) => {
      const aText = a.cells[hiddenColIndex].textContent.trim();
      const bText = b.cells[hiddenColIndex].textContent.trim();
      return ascending ? aText.localeCompare(bText) : bText.localeCompare(aText);
    });

    rows.forEach(row => tbody.appendChild(row));
  }
</script>

</body>
</html>
